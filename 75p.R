set.seed(12)
n1 = 4; n2 = 9; n3 = 25; n4 = 36
par(mfrow = c(3,1))
par(bg = "white", col.axis = "white", col.lab = "white",
    col.main = "white", col.sub = "white", xaxt = "n", yaxt = "n" , bty = "n")

#(1)#############################################################################

sample = rnorm(n1, 3, 5)
sample_mean = round(sample, 1)

x = seq(-15, 20, length.out = 100)
y1 = dnorm(x, 3, 5)
plot(x, y1, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.02,max(y1)+0.05))
stripchart(sample, add=TRUE,at=0.004,cex=2, pch=16,col="red")
stripchart(mean(sample), add=TRUE,at=-0.009,cex=2, pch=24,col="blue",bg="blue")
lines(x = c(-15, 20), y = c(0, 0), col = "black", lwd = 2)
arrows(3,0.02,mean(sample),0,length = 0.11)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.017, expression(mu * "=3"),cex=1.3)
text(-7, max(y1)+0.02, "X ~ N(3,5)",cex=1.4)
text(3, 0.03, cex=1.3,substitute(paste(bar(x), " = ", mean),list(mean=round(mean(sample),1))))


x = seq(-6, 12, length.out = 100)
y2 = dnorm(x, 3, 5/sqrt(n1))
alpha = qnorm(0.95, mean = 0, sd = 2.5)
plot(x, y2, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.03,max(y2)+0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 3, 5/sqrt(n1)),col="black", lwd = 2)
lines(x = c(-6, 12), y = c(0, 0), col = "black", lwd = 2)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.026, expression(mu * "=3"),cex=1.4)
text(-7, max(y2)-0.039, expression(bar(x)*"~" *N(3,frac(5,sqrt(4)))),cex=1.5)
stripchart(mean(sample), add=TRUE,at=-0.02,cex=2, pch=24,col="blue",bg="blue")
arrows(12, max(y2)-0.08,6.5,max(y2)-0.15,length=0.1)
text(12, max(y2)-0.039, expression("1-"*beta*"="*0.33), cex=1.3)


x = seq(-9, 9, length.out = 100)
y2 = dnorm(x, 0, 5/sqrt(n1))
plot(x, y2, type = "l", lwd = 2, xaxt="s", xlim = c(-15, 20), ylim = c(-0.05, max(y2) + 0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 0, 5/sqrt(n1)),col="black", lwd = 2)
lines(x = c(-9, 9), y = c(0, 0), col = "black", lwd = 2)
text(alpha, -0.015, round(alpha,2) ,cex=1)
axis(side = 1, at = seq(-15, 20, by = 5),label = seq(-15, 20, by = 5))
text(0, 0.02, expression(mu * "=0"),cex=1)
segments(0, 0, 0, 0.009, lwd = 2)
text(-7, max(y2)-0.039, expression(N(0,frac(5,sqrt(4)))),cex=1.5)
stripchart(mean(sample), add=TRUE,at=-0.02,cex=2, pch=24,col="blue",bg="blue")
arrows(7, max(y2)-0.08,4.8,max(y2)-0.15,length=0.1)
text(12, max(y2)-0.01, expression("Do not reject "*H[0]), cex=1.3)
text(9.2, max(y2)-0.05, expression(alpha*"=0.05"), cex=1.1)

##(2)############################################################################

par(mfrow = c(3,1))
par(bg = "white", col.axis = "white", col.lab = "white", col.main = "white", 
    col.sub = "white", xaxt = "n", yaxt = "n" , bty = "n")

sample = rnorm(n2, 3, 5)
sample_mean = round(sample, 1)

x = seq(-15, 20, length.out = 100)
y1 = dnorm(x, 3, 5)
plot(x, y1, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.02,max(y1)+0.05))
stripchart(sample, add=TRUE, at=0.004, cex=2, pch=16, col="red")
stripchart(mean(sample), add=TRUE,at=-0.009,cex=2, pch=24,col="blue",bg="blue")
lines(x = c(-15, 20), y = c(0, 0), col = "black", lwd = 2)
arrows(3,0.02,mean(sample),0,length = 0.11)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.017, expression(mu * "=3"),cex=1.3)
text(-7, max(y1)+0.02, "X ~ N(3,5)",cex=1.4)
text(3, 0.03, cex=1.3,substitute(paste(bar(x), " = ", mean),list(mean=round(mean(sample),1))))


x = seq(-6, 12, length.out = 100)
y2 = dnorm(x, 3, 5/sqrt(n2))
alpha = qnorm(0.95, mean = 0, sd =5/sqrt(n2))
plot(x, y2, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.03,max(y2)+0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 3, 5/sqrt(n2)),col="black", lwd = 2)
lines(x = c(-6, 12), y = c(0, 0), col = "black", lwd = 2)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.026, expression(mu * "=3"),cex=1.4)
text(-7, max(y2)-0.039, expression(bar(x)*"~" *N(3,frac(5,sqrt(9)))),cex=1.5)
stripchart(mean(sample), add=TRUE,at=-0.02,cex=2, pch=24,col="blue",bg="blue")
arrows(10, max(y2)-0.08,5.1,max(y2)-0.2,length=0.1)
text(12, max(y2)-0.039, expression("1-"*beta*"="*0.56), cex=1.3)


x = seq(-9, 9, length.out = 100)
y2 = dnorm(x, 0, 5/sqrt(n2))
plot(x, y2, type = "l", lwd = 2, xaxt="s", xlim = c(-15, 20), ylim = c(-0.05, max(y2) + 0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 0, 5/sqrt(n2)),col="black", lwd = 2)
lines(x = c(-9, 9), y = c(0, 0), col = "black", lwd = 2)
text(alpha, -0.03, round(alpha,2) ,cex=1)
axis(side = 1, at = seq(-15, 20, by = 5),label = seq(-15, 20, by = 5))
text(0, 0.02, expression(mu * "=0"),cex=1)
segments(0, 0, 0, 0.009, lwd = 2)
text(-7, max(y2)-0.039, expression(N(0,frac(5,sqrt(9)))),cex=1.5)
stripchart(mean(sample), add=TRUE,at=-0.02,cex=2, pch=24,col="blue",bg="blue")
arrows(7, max(y2)-0.15,3.1,max(y2)-0.23,length=0.1)
text(12, max(y2)-0.1, expression("Do not reject "*H[0]), cex=1.3)
text(9.2, max(y2)-0.13, expression(alpha*"=0.05"), cex=1.3)

###(3)###########################################################################

par(mfrow = c(3,1))
par(bg = "white", col.axis = "white", col.lab = "white", col.main = "white", 
    col.sub = "white", xaxt = "n", yaxt = "n" , bty = "n")

sample = rnorm(n3, 3, 5)
sample_mean = round(sample, 1)

x = seq(-15, 20, length.out = 100)
y1 = dnorm(x, 3, 5)
plot(x, y1, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.02,max(y1)+0.05))
stripchart(sample, add=TRUE, at=0.004, cex=2, pch=16, col="red")
stripchart(mean(sample_mean), add=TRUE,at=-0.006,cex=1.5, pch=24,col="blue",bg="blue")
lines(x = c(-15, 20), y = c(0, 0), col = "black", lwd = 2)
arrows(3,0.02,mean(sample),0,length = 0.11)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.017, expression(mu * "=3"),cex=1.3)
text(-7, max(y1)+0.02, "X ~ N(3,5)",cex=1.8)
text(3, 0.03, cex=1.7,substitute(paste(bar(x), " = ", mean),list(mean=round(mean(sample),1))))


x = seq(-6, 12, length.out = 100)
y2 = dnorm(x, 3, 5/sqrt(n3))
alpha = qnorm(0.95, mean = 0, sd =5/sqrt(n3))
plot(x, y2, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.03,max(y2)+0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 3, 5/sqrt(n3)),col="black", lwd = 2)
lines(x = c(-6, 12), y = c(0, 0), col = "black", lwd = 2)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.02999, expression(mu * "=3"),cex=1.4)
text(-7, max(y2)-0.039, expression(bar(x)*"~" *N(3,frac(5,sqrt(25)))),cex=1.8)
stripchart(mean(sample), add=TRUE,at=0,cex=1.7, pch=24,col="blue",bg="blue")
arrows(10, max(y2)-0.08,mean(sample_mean),max(y2)-0.3,length=0.1)
text(12, max(y2)-0.039, expression("1-"*beta*"="*0.91), cex=1.7)


x = seq(-9, 9, length.out = 100)
y2 = dnorm(x, 0, 5/sqrt(n3))
plot(x, y2, type = "l", lwd = 2, xaxt="s", xlim = c(-15, 20), ylim = c(-0.05, max(y2) + 0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 0, 5/sqrt(n3)),col="black", lwd = 2)
lines(x = c(-9, 9), y = c(0, 0), col = "black", lwd = 2)
text(alpha, -0.03, round(alpha,2) ,cex=1)
axis(side = 1, at = seq(-15, 20, by = 5),label = seq(-15, 20, by = 5))
text(0, 0.02, expression(mu * "=0"),cex=1)
segments(0, 0, 0, 0.009, lwd = 2)
text(-7, max(y2)-0.039, expression(N(0,frac(5,sqrt(25)))),cex=1.8)
stripchart(mean(sample), add=TRUE,at=-0.016,cex=2, pch=24,col="blue",bg="blue")
arrows(7, max(y2)-0.22,1.9,max(y2)-0.38,length=0.1)
text(10.5, max(y2)-0.2, expression("Reject "*H[0]), cex=1.5)
text(10, max(y2)-0.25, expression(alpha*"=0.05"), cex=1.5)

####(4)##########################################################################

par(mfrow = c(3,1))
par(bg = "white", col.axis = "white", col.lab = "white", col.main = "white", 
    col.sub = "white", xaxt = "n", yaxt = "n" , bty = "n")

sample = rnorm(n4, 3, 5)
sample_mean = round(sample, 1)

x = seq(-15, 20, length.out = 100)
y1 = dnorm(x, 3, 5)
plot(x, y1, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.02,max(y1)+0.05))
stripchart(sample, add=TRUE, at=0.004, cex=2, pch=16, col="red")
stripchart(mean(sample_mean), add=TRUE,at=-0.006,cex=1.5, pch=24,col="blue",bg="blue")
lines(x = c(-15, 20), y = c(0, 0), col = "black", lwd = 2)
arrows(3,0.02,mean(sample_mean),0,length = 0.11)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.017, expression(mu * "=3"),cex=1.3)
text(-7, max(y1)+0.02, "X ~ N(3,5)",cex=1.8)
text(3, 0.03, cex=1.7,substitute(paste(bar(x), " = ", mean),list(mean=round(mean(sample),1))))


x = seq(-6, 12, length.out = 100)
y2 = dnorm(x, 3, 5/sqrt(n4))
alpha = qnorm(0.95, mean = 0, sd =5/sqrt(n4))
plot(x, y2, type = "l", lwd = 2, xlim = c(-15, 20),ylim=c(-0.03,max(y2)+0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 3, 5/sqrt(n4)),col="black", lwd = 2)
lines(x = c(-6, 12), y = c(0, 0), col = "black", lwd = 2)
segments(3, 0, 3, -0.009, lwd = 2)
text(3, -0.02999, expression(mu * "=3"),cex=1.4)
text(-7, max(y2)-0.039, expression(bar(x)*"~" *N(3,frac(5,sqrt(36)))),cex=1.8)
stripchart(mean(sample), add=TRUE,at=0.015,cex=1.7, pch=24,col="blue",bg="blue")
arrows(10, max(y2)-0.08,mean(sample_mean),max(y2)-0.3,length=0.1)
text(12, max(y2)-0.039, expression("1-"*beta*"="*0.91), cex=1.7)


x = seq(-9, 9, length.out = 100)
y2 = dnorm(x, 0, 5/sqrt(n4))
plot(x, y2, type = "l", lwd = 2, xaxt="s", xlim = c(-15, 20), ylim = c(-0.05, max(y2) + 0.05))
polygon(c(alpha, x[x>=alpha], tail(x[x>=alpha], 1)), c(0, y2[x>=alpha], 0), col="#FF00004D", border=NA)
segments(alpha, 0, alpha,dnorm(alpha, 0, 5/sqrt(n4)),col="black", lwd = 2)
lines(x = c(-9, 9), y = c(0, 0), col = "black", lwd = 2)
text(alpha, -0.03, round(alpha,2) ,cex=1)
axis(side = 1, at = seq(-15, 20, by = 5),label = seq(-15, 20, by = 5))
text(0, 0.02, expression(mu * "=0"),cex=1)
segments(0, 0, 0, 0.009, lwd = 2)
text(-7, max(y2)-0.039, expression(N(0,frac(5,sqrt(36)))),cex=1.8)
stripchart(mean(sample), add=TRUE,at=-0.016,cex=2, pch=24,col="blue",bg="blue")
arrows(6, max(y2)-0.25,1.5,max(y2)-0.45,length=0.1)
text(9, max(y2)-0.2, expression("Reject "*H[0]), cex=1.5)
text(8.5, max(y2)-0.25, expression(alpha*"=0.05"), cex=1.5)